# 空间规划政策爬虫与合规性分析系统

## 📋 项目简介

本项目是一个专门用于爬取和分析空间规划政策数据的桌面应用程序。系统集成了智能爬虫、数据管理、合规性分析、政策对比和数据导出等功能，主要面向国土空间规划、城市更新等领域的政策研究人员和从业人员。

## ✨ 核心功能

### 🕷️ 智能爬虫系统
- **多源数据爬取**：支持国家住建部等官方机构的政策数据爬取
- **智能反爬虫**：内置多种反爬虫策略，支持快速/正常/慢速三种模式
- **实时进度显示**：爬取过程中实时显示进度和数据获取情况
- **关键词过滤**：支持多关键词组合搜索，精确匹配目标政策

### 📊 数据管理与分析
- **本地数据库存储**：使用 SQLite 数据库，支持离线查询
- **智能数据更新**：自动检测数据时效性，智能判断是否需要更新
- **分页显示**：支持大量数据的分页浏览和快速定位

### 🔍 合规性分析
- **政策合规性评估**：对政策文本进行合规性评分和风险识别
- **关键词高亮**：自动识别和高亮显示关键政策条款
- **风险等级分类**：根据合规性分析结果进行风险等级划分

### 🔄 政策对比功能
- **多政策对比**：支持多个政策文件的相似度对比
- **智能匹配**：基于文本相似度算法进行政策条款匹配
- **差异分析**：自动识别政策间的差异点和变化趋势

### 📤 数据导出
- **多格式支持**：支持导出为 Word、Excel 等常用格式
- **自定义模板**：支持自定义导出模板和格式
- **批量导出**：支持批量导出选定的政策数据

## 🖥️ 图形界面

- **现代化界面**：基于 PyQt5 构建的现代化桌面界面
- **操作简便**：预设模式选择，一键启动常用功能
- **实时反馈**：操作过程中实时显示进度和状态信息
- **多窗口支持**：支持多窗口操作，提高工作效率

## 📁 项目结构

```
kj/
├── src/space_planning/          # 源代码目录
│   ├── main.py                  # 主程序入口
│   ├── core/                    # 核心模块
│   │   ├── config.py           # 配置管理
│   │   └── database.py         # 数据库操作
│   ├── gui/                     # 图形界面
│   │   └── main_window.py      # 主窗口界面
│   ├── spider/                  # 爬虫模块
│   │   ├── national.py         # 国家级政策爬虫
│   │   ├── anti_crawler.py     # 反爬虫策略
│   │   └── monitor.py          # 爬虫监控
│   └── utils/                   # 工具模块
│       ├── compare.py          # 政策对比
│       ├── compliance.py       # 合规性分析
│       └── export.py           # 数据导出
├── docs/                        # 文档目录
├── venv/                        # 虚拟环境
├── requirements.txt             # 依赖包列表
├── 启动程序.bat                # Windows启动脚本
├── 打包脚本.bat                # 项目打包脚本
├── 版本发布.bat                # 版本发布工具
└── README.md                   # 项目说明
```

## 🚀 快速开始

### 环境要求
- **操作系统**：Windows 7/8/10/11 (64位)
- **Python版本**：Python 3.7 及以上
- **内存要求**：建议 4GB 以上
- **网络要求**：需要稳定的互联网连接

### 安装步骤

1. **克隆项目**
   ```bash
   git clone https://gitee.com/ViVi141/space-planning-spider.git
   cd space-planning-spider
   ```

2. **创建虚拟环境**（推荐）
   ```bash
   python -m venv venv
   venv\Scripts\activate
   ```

3. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

4. **启动程序**
   ```bash
   # 方式一：直接运行
   python src/space_planning/main.py
   
   # 方式二：使用启动脚本（Windows）
   启动程序.bat
   ```

## 📖 使用指南

### 基本操作流程

1. **选择预设模式**
   - 日常监控模式：最近30天的政策数据
   - 项目分析模式：最近6个月的政策数据
   - 历史补全模式：最近2年的政策数据

2. **设置搜索参数**
   - 选择目标机构（国家住建部等）
   - 输入关键词（可选，支持多关键词）
   - 设置时间范围（可选）

3. **执行智能搜索**
   - 点击"智能查询"按钮
   - 系统自动判断是否需要爬取新数据
   - 实时显示查询和爬取进度

4. **后续分析操作**
   - 查看政策详情
   - 进行合规性分析
   - 执行政策对比
   - 导出数据

### 高级功能

#### 合规性分析
1. 选择要分析的政策
2. 输入项目关键词
3. 系统自动进行合规性评估
4. 查看分析结果和风险等级

#### 政策对比
1. 选择多个政策文件
2. 系统自动计算相似度
3. 查看对比结果和差异分析

#### 数据导出
1. 选择要导出的数据
2. 选择导出格式（Word/Excel）
3. 选择保存位置
4. 完成导出

## 🔧 技术架构

### 核心技术栈
- **GUI框架**：PyQt5 - 现代化桌面界面
- **网络请求**：requests - HTTP请求处理
- **HTML解析**：BeautifulSoup4 + lxml - 网页内容解析
- **数据库**：SQLite - 本地数据存储
- **文本处理**：fuzzywuzzy + python-Levenshtein - 文本相似度计算
- **文档处理**：python-docx - Word文档生成

### 系统架构
- **模块化设计**：核心功能模块化，便于维护和扩展
- **多线程处理**：爬虫和界面分离，避免界面卡顿
- **事件驱动**：基于信号槽机制的事件处理
- **配置管理**：统一的配置管理和环境适配

## 📦 依赖包说明

```
PyQt5              # GUI界面框架
requests           # HTTP网络请求库
beautifulsoup4     # HTML解析库
python-docx        # Word文档处理
fuzzywuzzy         # 文本相似度计算
python-Levenshtein # 编辑距离算法优化
lxml               # XML/HTML解析器
```

## 🛠️ 开发工具

### 自动化脚本
- **启动程序.bat**：快速启动应用程序
- **打包脚本.bat**：自动化打包为可执行文件
- **版本发布.bat**：自动化版本发布流程
- **git提交.bat**：简化Git操作流程

### 诊断工具
- **网络诊断工具.bat**：网络连接问题诊断
- **数据库路径测试.bat**：数据库路径配置测试
- **清理打包文件.bat**：清理临时打包文件

## 🐛 常见问题

### Q: 程序启动时提示缺少Qt插件？
A: 这是PyQt5环境配置问题，程序已内置自动修复功能，重新启动即可。

### Q: 爬虫无法获取数据？
A: 请检查网络连接，或尝试调整爬取速度模式（快速/正常/慢速）。

### Q: 数据库路径错误？
A: 运行"数据库路径测试.bat"进行诊断，或检查程序运行权限。

### Q: 依赖包安装失败？
A: 建议使用国内镜像源：
```bash
pip install -r requirements.txt -i https://pypi.tuna.tsinghua.edu.cn/simple/
```

## 📄 版本信息

当前版本：v1.1.1
- 修复数据库路径问题，解决打包后无法爬取的问题
- 增加网络环境兼容性检测和诊断工具
- 优化用户界面和操作体验

详细版本历史请查看 [版本管理说明.md](版本管理说明.md)

## 📄 许可证

本项目采用 MIT 许可证 - 查看 [LICENSE](LICENSE) 文件了解详情。

## 🤝 贡献指南

欢迎提交 Issue 和 Pull Request！

1. Fork 本仓库
2. 创建特性分支 (`git checkout -b feature/AmazingFeature`)
3. 提交更改 (`git commit -m 'Add some AmazingFeature'`)
4. 推送到分支 (`git push origin feature/AmazingFeature`)
5. 打开 Pull Request

## 📞 联系方式

如有问题或建议，请通过以下方式联系：

- 提交 Issue：[Gitee Issues](https://gitee.com/ViVi141/space-planning-spider/issues)
- 邮箱：747384120@qq.com

## ⭐ 如果这个项目对您有帮助，请给个Star！

---

**免责声明**：本项目仅供学习和研究使用，请遵守相关法律法规和网站使用条款。使用本软件进行数据爬取时，请确保遵守目标网站的robots.txt协议和使用条款。 