# 分条导出功能说明

**更新日期**: 2025.10.29  
**版本**: v3.0.1

---

## 🎯 功能概述

**分条导出**是一个新增的导出功能，允许将政策数据按**一个政策一个文件**的方式导出。

### 主要特点
- ✅ **一个政策一个文件**: 每个政策独立保存为单独的文件
- ✅ **扁平化目录结构**: 所有文件直接放在指定目录，不创建子目录
- ✅ **多格式支持**: 支持Word、文本、Markdown三种格式
- ✅ **文件命名规范**: 使用序号+标题的方式命名文件
- ✅ **自动清理文件名**: 自动移除Windows不支持的字符

---

## 📁 目录结构

分条导出使用**扁平化目录结构**，所有文件直接放在指定目录：

```
输出目录/
├── 0001_关于加强空间规划工作的通知.docx
├── 0002_关于推动国土空间规划的指导意见.docx
├── 0003_关于印发空间规划管理办法的通知.docx
├── 0004_关于深化规划改革的意见.docx
└── 0005_关于启动新一轮空间规划编制的通知.docx
```

**注意**: 不再创建子目录，所有文件直接在指定目录下

### 文件命名规则
- 格式: `序号_标题.扩展名`
- 序号: 4位数字（0001, 0002, 0003...）
- 标题: 政策标题（自动清理非法字符）
- 示例: `0001_关于加强空间规划工作的通知.docx`

---

## 🚀 使用方法

### 1. 选择政策和格式
1. 在政策列表中选择要导出的政策
2. 点击"导出"按钮
3. 在格式选择框中选择：
   - **分条导出Word文档 (每个政策一个文件)**
   - **分条导出文本文件 (每个政策一个文件)**
   - **分条导出Markdown (每个政策一个文件)**

### 2. 选择输出目录
- 选择或创建一个文件夹作为输出目录
- 所有政策文件将直接保存在该目录下

### 3. 查看导出结果
- 程序会显示导出成功的提示信息
- 显示导出的文件总数
- 显示输出目录路径

---

## 📋 支持的文件格式

### 1. Word文档 (.docx)

**文件结构**:
```markdown
标题（居中）

发布机构：[机构名称]
发布日期：[日期]
来源：[来源链接]

正文：
[政策正文内容]
```

**特点**:
- 标题居中
- 清晰的层次结构
- 适用于打印和文档管理

### 2. 文本文件 (.txt)

**文件结构**:
```text
政策标题
================================================================================

发布机构：机构名称
发布日期：日期
来源：来源链接

--------------------------------------------------------------------------------

正文：
[政策正文内容]
```

**特点**:
- 纯文本格式
- 易于阅读和处理
- 兼容性最好

### 3. Markdown文档 (.md)

**文件结构**:
```markdown
# 政策标题

---

**发布机构：** 机构名称

**发布日期：** 日期

**来源：** 来源链接

---

## 正文

[政策正文内容]
```

**特点**:
- 支持Markdown语法
- 便于版本控制
- 易于转换为其他格式

---

## ⚙️ 技术实现

### 核心函数

```python
def export_individual_files(data, output_dir, format_type='word'):
    """
    分条导出 - 一个政策一个文件
    
    Args:
        data: 政策数据列表
        output_dir: 输出目录
        format_type: 输出格式 ('word', 'txt', 'markdown')
    
    Returns:
        Dict: 导出结果信息
    """
```

### 主要步骤

1. **数据解析**
   - 从列表或字典格式解析政策数据
   - 提取标题、机构、日期、来源、内容

2. **文件生成**
   - 清理文件名（移除非法字符）
   - 按格式生成文件
   - 保存到对应目录

4. **结果返回**
   - 返回导出的文件列表
   - 返回导出总数
   - 返回错误信息（如有）

---

## 🔧 文件名清理规则

### 移除的字符
- `< > : " / \ | ? *` (Windows不支持的文件名字符)
- 连续空格
- 文件名长度限制为200字符

### 示例
- 原始标题: `关于加强<空间规划>工作的通知`
- 清理后: `关于加强_空间规划_工作的通知`
- 最终文件名: `0001_关于加强_空间规划_工作的通知.docx`

---

## 💡 使用场景

### 1. 文档归档
- 将政策文件集中管理
- 统一目录便于查找
- 适用于长期保存

### 2. 批量处理
- 需要对每个政策单独处理
- 适用于文档分析和研究
- 方便程序化处理

### 3. 版本控制
- 便于跟踪每个政策的版本
- 适用于文档管理系统
- 支持Git等版本控制工具

### 4. 数据迁移
- 从数据库迁移到文件系统
- 备份和恢复政策数据
- 数据格式转换

---

## ⚠️ 注意事项

### 1. 文件数量限制
- Windows系统单目录文件数量建议不超过1万
- 如果文件数量较大，建议分批导出

### 2. 文件名长度
- 文件名会被限制在200字符以内
- 超长标题会被自动截断

### 3. 特殊字符处理
- 文件名中的特殊字符会被替换为下划线
- 保留中文、英文和数字

### 4. 导出速度
- 大量文件导出可能需要较长时间
- 建议分批导出（一次不超过1000个政策）

---

## 🐛 已知问题和限制

### 当前限制
- ❌ 不支持Excel分条导出（Excel格式本身就是表格，不适合分条）
- ❌ 不支持自定义文件名规则
- ❌ 不支持批量重命名导出的文件
- ❌ 不支持子目录分组（所有文件在同一目录下）

### 未来改进
- 📅 支持自定义文件命名规则
- 📅 支持导出进度显示
- 📅 支持断点续传
- 📅 支持按日期自动分组子目录（可选）

---

## 📊 性能数据

### 测试环境
- 系统: Windows 10
- Python: 3.x
- 测试数据: 100个政策

### 导出速度
| 格式 | 100个文件 | 1000个文件 |
|------|----------|------------|
| Word | ~2秒 | ~20秒 |
| 文本 | ~1秒 | ~10秒 |
| Markdown | ~1秒 | ~10秒 |

### 文件大小
| 格式 | 平均文件大小 |
|------|-------------|
| Word (.docx) | 10-50KB |
| 文本 (.txt) | 5-30KB |
| Markdown (.md) | 5-30KB |

---

## 🎨 界面截图

### 导出对话框
```
┌─────────────────────────────────┐
│  选择政策和导出格式             │
├─────────────────────────────────┤
│                                 │
│  ☑ 全选                        │
│  ☐ 1. 政策A (住建部)          │
│  ☐ 2. 政策B (自然资源部)      │
│  ☐ 3. 政策C (广东省)          │
│                                 │
│  请选择导出格式：              │
│  ┌─────────────────────────┐  │
│  │ Word文档 (*.docx) ▼     │  │
│  │ Excel表格 (*.xlsx)       │  │
│  │ 文本文件 (*.txt)         │  │
│  │ Markdown文档 (*.md)      │  │
│  │ --- 分条导出 ---         │  │
│  │ 📄 分条导出Word          │  │
│  │ 📄 分条导出文本          │  │
│  │ 📄 分条导出Markdown      │  │
│  └─────────────────────────┘  │
│                                 │
│         [确定]  [取消]          │
└─────────────────────────────────┘
```

---

## 📝 更新日志

### v3.0.1 (2025.10.29)
- ✅ 新增分条导出功能
- ✅ 支持Word、文本、Markdown三种格式
- ✅ 扁平化目录结构（所有文件在同一目录）
- ✅ 智能文件名清理
- ✅ 完整的GUI集成

---

**文档版本**: 1.0  
**最后更新**: 2025.10.29  
**维护者**: ViVi141

