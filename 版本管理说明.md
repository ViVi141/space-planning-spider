# 版本管理说明

## 版本号规范

### 语义化版本号 (Semantic Versioning)
格式：`主版本号.次版本号.修订号`

- **主版本号**：不兼容的API修改
- **次版本号**：向下兼容的功能性新增
- **修订号**：向下兼容的问题修正

### 版本历史

| 版本号 | 发布日期 | 主要更新 |
|--------|----------|----------|
| v1.1.1 | 2024-12-19 | 修复数据库路径问题，解决打包后无法爬取的问题 |
| v1.1.0 | 2024-12-19 | 增加网络环境兼容性检测和诊断工具 |
| v1.0.0 | 2024-12-19 | 初始版本发布 |

## 发布流程

### 1. 使用版本发布工具（推荐）

```bash
# 运行版本发布工具
版本发布.bat
```

选择"4. 完整发布流程"，按提示操作：
1. 输入版本号（如：v1.1.1）
2. 输入提交信息
3. 自动完成提交、标签、推送

### 2. 手动发布流程

```bash
# 1. 添加文件
git add .

# 2. 提交更改
git commit -m "v1.1.1: 修复数据库路径问题"

# 3. 创建版本标签
git tag v1.1.1

# 4. 推送到Gitee
git push origin master
git push origin --tags
```

## 版本发布检查清单

### 发布前检查
- [ ] 代码功能测试通过
- [ ] 数据库路径配置正确
- [ ] 网络连接功能正常
- [ ] 打包测试通过
- [ ] 文档更新完成

### 发布后检查
- [ ] Gitee仓库更新成功
- [ ] 版本标签创建成功
- [ ] 下载链接正常
- [ ] 用户反馈收集

## 分支管理

### 主分支 (master)
- 稳定版本代码
- 用于生产环境
- 每次提交都应该可运行

### 开发分支 (develop)
- 开发中的功能
- 集成测试
- 准备合并到master

### 功能分支 (feature/*)
- 新功能开发
- 从develop分支创建
- 完成后合并回develop

## 提交信息规范

### 格式
```
类型(范围): 简短描述

详细描述（可选）

关联问题（可选）
```

### 类型说明
- **feat**: 新功能
- **fix**: 修复bug
- **docs**: 文档更新
- **style**: 代码格式调整
- **refactor**: 代码重构
- **test**: 测试相关
- **chore**: 构建过程或辅助工具的变动

### 示例
```
fix(database): 修复打包后数据库路径问题

- 更新数据库路径配置，支持打包环境
- 添加数据库路径测试工具
- 改进错误处理和诊断功能

解决 #123 问题
```

## 标签管理

### 创建标签
```bash
# 轻量标签
git tag v1.1.1

# 带注释的标签
git tag -a v1.1.1 -m "版本1.1.1发布"
```

### 推送标签
```bash
# 推送所有标签
git push origin --tags

# 推送特定标签
git push origin v1.1.1
```

### 删除标签
```bash
# 删除本地标签
git tag -d v1.1.1

# 删除远程标签
git push origin --delete v1.1.1
```

## 回滚操作

### 回滚到指定版本
```bash
# 查看提交历史
git log --oneline

# 回滚到指定提交
git reset --hard <commit-hash>

# 强制推送（谨慎使用）
git push origin master --force
```

### 创建回滚版本
```bash
# 创建回滚标签
git tag v1.1.0-rollback

# 推送回滚标签
git push origin v1.1.0-rollback
```

## 自动化工具

### 版本发布工具
- **文件**: `版本发布.bat`
- **功能**: 自动化版本发布流程
- **使用**: 双击运行，按提示操作

### Git提交工具
- **文件**: `git提交.bat`
- **功能**: 简化Git操作
- **使用**: 双击运行，选择操作

## 最佳实践

### 1. 版本发布频率
- 重大功能更新：主版本号
- 新功能添加：次版本号
- Bug修复：修订号

### 2. 提交粒度
- 每次提交只做一件事
- 提交信息要清晰明确
- 避免大文件提交

### 3. 测试要求
- 发布前必须测试
- 包含自动化测试
- 用户反馈收集

### 4. 文档同步
- 更新README.md
- 更新版本历史
- 更新使用说明

## 常见问题

### Q: 推送失败怎么办？
A: 先拉取最新代码，解决冲突后再推送

### Q: 标签创建失败？
A: 检查版本号是否已存在，确保版本号唯一

### Q: 如何撤销错误的提交？
A: 使用 `git reset` 或 `git revert` 命令

### Q: 如何查看版本历史？
A: 使用 `git log --oneline` 或版本发布工具

## 联系支持

如有版本管理问题，请：
1. 查看本文档
2. 使用诊断工具
3. 提交Issue到Gitee
4. 联系开发团队 