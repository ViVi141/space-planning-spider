# Windows安装程序打包说明

## 版本信息
- **版本：** v2.1.0
- **更新时间：** 2025.7.8
- **打包工具：** PyInstaller + Inno Setup

## 打包方式

### 方式一：快速打包（基础版）
1. 双击运行 `快速打包.bat`
2. 脚本会自动完成所有打包步骤
3. 生成文件：
   - `dist/空间规划政策爬虫系统.exe` - 单个可执行文件
   - `dist/空间规划政策爬虫系统_便携版/` - 便携版文件夹

### 方式二：完整打包（推荐）
1. 双击运行 `完整打包.bat`
2. 包含标准Windows安装程序和便携版
3. 生成文件：
   - `installer/空间规划政策爬虫系统_v2.1.0_安装程序.exe` - 标准安装程序
   - `dist/空间规划政策爬虫系统_便携版/` - 便携版文件夹
   - `dist/空间规划政策爬虫系统.exe` - 单个可执行文件

### 方式三：手动打包
1. 激活虚拟环境：`venv\Scripts\activate.bat`
2. 安装依赖：`pip install -r requirements.txt`
3. 安装PyInstaller：`pip install pyinstaller`
4. 运行打包脚本：`python build_complete_installer.py`

## 系统要求

### 开发环境
- **Python：** 3.7或更高版本
- **操作系统：** Windows 10/11
- **内存：** 至少4GB RAM
- **磁盘空间：** 至少2GB可用空间
- **Inno Setup：** 用于生成标准安装程序（可选）

### 运行环境
- **操作系统：** Windows 7/8/10/11 (64位)
- **内存：** 至少2GB RAM
- **磁盘空间：** 至少500MB可用空间
- **网络：** 需要互联网连接进行数据爬取

## 打包文件说明

### 1. 标准Windows安装程序
- **文件：** `空间规划政策爬虫系统_v2.1.0_安装程序.exe`
- **特点：** 标准的Windows安装程序
- **功能：**
  - 可在"程序和功能"中看到和管理
  - 包含完整的安装向导
  - 自动安装到程序目录
  - 创建开始菜单快捷方式
  - 创建桌面快捷方式（可选）
  - 支持标准卸载功能
  - 注册表信息管理
- **适用：** 正式发布，用户友好

### 2. 便携版
- **文件夹：** `空间规划政策爬虫系统_便携版/`
- **内容：**
  - `空间规划政策爬虫系统.exe` - 主程序
  - `启动程序.bat` - 启动脚本
  - `卸载程序.bat` - 卸载脚本
  - `使用说明.txt` - 使用说明
  - `LICENSE` - 许可证文件
  - `README.md` - 说明文档
  - `CHANGELOG.md` - 更新日志
  - `版本管理说明.md` - 版本说明
- **特点：** 包含启动脚本、卸载程序和完整文档
- **适用：** 便携使用，适合U盘携带

### 3. 单个可执行文件
- **文件：** `空间规划政策爬虫系统.exe`
- **特点：** 包含所有依赖，单个文件即可运行
- **大小：** 约45MB
- **适用：** 简单分发，无需安装

## 安装程序特性

### 标准安装程序功能
- ✅ **系统集成：** 在"程序和功能"中显示
- ✅ **安装向导：** 完整的安装界面
- ✅ **快捷方式：** 自动创建开始菜单和桌面快捷方式
- ✅ **卸载功能：** 支持标准卸载
- ✅ **注册表管理：** 自动管理注册表信息
- ✅ **版本信息：** 包含完整的版本信息
- ✅ **权限管理：** 支持用户权限控制

### 便携版功能
- ✅ **即插即用：** 无需安装，直接运行
- ✅ **数据本地化：** 数据存储在程序目录
- ✅ **完整文档：** 包含所有说明文档
- ✅ **卸载工具：** 提供卸载脚本
- ✅ **U盘友好：** 适合U盘携带使用

## 打包配置

### PyInstaller配置
- **模式：** `--onefile` - 打包成单个文件
- **窗口：** `--windowed` - 无控制台窗口
- **图标：** `docs/icon.ico` - 程序图标
- **数据文件：** 包含LICENSE、README等文档
- **版本信息：** 包含完整的版本信息

### Inno Setup配置
- **压缩：** LZMA压缩
- **语言：** 中文简体
- **权限：** 最低权限要求
- **架构：** 64位支持
- **注册表：** 自动管理注册表信息

### 隐藏导入
- PyQt5相关模块
- requests、bs4、lxml等网络和解析库
- fuzzywuzzy、Levenshtein等文本处理库
- python-docx文档处理库

## 安装程序安装流程

### 标准安装程序
1. **欢迎界面：** 显示程序信息和版本
2. **许可协议：** 显示软件许可协议
3. **安装位置：** 选择安装目录
4. **开始菜单：** 选择开始菜单文件夹
5. **附加任务：** 选择是否创建桌面快捷方式
6. **安装进度：** 显示安装进度
7. **完成安装：** 安装完成，可选择启动程序

### 便携版使用
1. **解压文件：** 将便携版文件夹解压到任意位置
2. **启动程序：** 双击"启动程序.bat"
3. **使用程序：** 正常使用程序功能
4. **卸载程序：** 双击"卸载程序.bat"或直接删除文件夹

## 常见问题

### 1. 打包失败
**问题：** PyInstaller打包失败
**解决：**
- 检查Python版本是否为3.7+
- 确保所有依赖包已正确安装
- 检查虚拟环境是否正确激活
- 查看错误日志，根据具体错误解决

### 2. 安装程序生成失败
**问题：** Inno Setup安装程序生成失败
**解决：**
- 检查Inno Setup是否正确安装
- 确保Inno Setup在系统PATH中
- 检查安装脚本语法是否正确
- 查看编译错误信息

### 3. 程序无法启动
**问题：** 打包后的程序无法启动
**解决：**
- 检查是否缺少依赖库
- 尝试在命令行运行，查看错误信息
- 确保目标机器有足够的权限
- 检查防火墙和杀毒软件设置

### 4. 安装程序无法卸载
**问题：** 标准安装程序无法正常卸载
**解决：**
- 检查程序是否正在运行
- 确保有足够的权限
- 使用管理员权限运行卸载程序
- 手动清理注册表信息

## 发布建议

### 1. 测试
- 在干净的系统上测试安装程序
- 测试所有功能是否正常
- 检查数据保存和读取功能
- 测试卸载功能是否正常

### 2. 文档
- 提供详细的使用说明
- 包含版本更新日志
- 提供技术支持联系方式
- 说明系统要求和兼容性

### 3. 分发
- 使用标准安装程序进行正式发布
- 使用便携版进行快速分发
- 提供在线下载链接
- 提供多种下载方式

## 技术支持

- **项目地址：** https://gitee.com/ViVi141/space-planning-spider
- **问题反馈：** 通过Gitee Issues提交
- **版本更新：** 关注项目发布页面
- **安装程序问题：** 检查Inno Setup文档

---

**注意：** 
- 打包过程可能需要几分钟时间，请耐心等待
- 标准安装程序需要Inno Setup支持
- 如果遇到问题，请查看控制台输出的错误信息
- 建议在发布前进行充分测试 